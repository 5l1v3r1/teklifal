<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <div class="container">
    <%= link_to t("common.site_name"), root_path, class: 'navbar-brand' %>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample07" aria-controls="navbarsExample07" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarsExample07">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <%= link_to t('common.new_announcement'), new_announcement_path, class: "nav-link" %>
        </li>
      </ul>

      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <%= link_to t('common.subscriptions'), home_pro_path, class: 'nav-link'  %>
        </li>
        <% if user_signed_in? %>
          <li class="nav-item dropdown">
            <%= link_to current_user.name, '#', class: 'nav-link dropdown-toggle', id: 'navbarDropdownMenuLink', data: { toggle: "dropdown" }, "aria-haspopup" => "true", "aria-expanded" => "false" %>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
              <%= link_to my_announcements_path, class: 'dropdown-item' do %>
                <%= t "announcements.my_announcements" %>
                <span class="badge badge-primary float-right">
                  <%= current_user.announcements.published.count %>
                </span>
              <% end %>
              <%= link_to my_offers_path, class: 'dropdown-item' do %>
                <%= t "offers.my_offers" %>
                <span class="badge badge-primary float-right ml-1">
                  <%= current_user.offers.joins(:announcement).where(state: 'published').where("announcements.expired_at > ?", Time.now).count %>
                </span>
                <span class="badge badge-warning float-right">
                  <%= current_user.offers.joins(:announcement).where(state: 'draft').where("announcements.expired_at > ?", Time.now).count %>
                </span>

              <% end %>
              <div class="dropdown-divider"></div>
              <%= link_to t("users.my_registration"), edit_user_registration_path, class: 'dropdown-item'  %>
              <%= link_to t("users.sign_out"), destroy_user_session_path, method: :delete, class: "dropdown-item"  %>
            </div>
          </li>
        <% else %>
          <li class="nav-item">
            <%= link_to t("users.sign_in"), new_user_session_path, class: 'nav-link'  %>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</nav>